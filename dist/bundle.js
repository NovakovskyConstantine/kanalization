(()=>{var i={691:()=>{class i{type;rotation;jointPoints=[];coordinates=[];filled;imageList=[];image;constructor(i,e,t,s){this.type=i,this.coordinates=e,this.rotation=t,"waterfall"==i&&(this.filled=!0),this.imageList=s,this.imageList&&(this.image=this.imageList[0]),this.setJointPoints(i,t)}setJointPoints(i,e){"waterfall"==i?this.jointPoints=[0,0,1,0]:"straight"==i?this.jointPoints=[0,1,0,1]:"duple"==i?this.jointPoints=[0,1,1,0]:"triple"==i?this.jointPoints=[1,1,1,0]:"cross"==i?this.jointPoints=[1,1,1,1]:"finish"==i&&(this.jointPoints=[0,0,1,0]);for(let i=0;i<e;i+=90)this.changeJointPoints()}changeJointPoints(){let i=[];for(let e=0;e<this.jointPoints.length;e++)3==e?i[0]=this.jointPoints[e]:i[e+1]=this.jointPoints[e];for(let e=0;e<i.length;e++)this.jointPoints[e]=i[e]}changeRotation(){this.rotation<270?this.rotation+=90:this.rotation=0,this.changeJointPoints()}}class e{spriteContainer;pixiLoader;pipeMatrix=[];pipeMatrixXLength;field;pipes=[];waterfallPipes=[];pipesToWin=[];getMenu;audio;constructor(e,t,s,r){this.audio=new Audio,this.audio.src="../resources/audio/click.mp3",this.spriteContainer=s,this.pixiLoader=r,this.getMenu=t;let p=0;for(let t=0;t<e.length;t++){this.pipeMatrix.push([]);for(let s=0;s<e[t].length;s++){let r,o="waterfall"==e[t][s].type?0:90*Math.floor(4*Math.random()),n=[];"waterfall"==e[t][s].type?this.pixiLoader.load((()=>{r=new PIXI.Sprite(this.pixiLoader.resources["../resources/pipes/waterfall.png"].texture),this.spriteContainer.stage.addChild(r),n=["../resources/pipes/waterfall.png","../resources/pipes/waterfall.png"]})):"finish"==e[t][s].type?this.pixiLoader.load((()=>{r=new PIXI.Sprite(this.pixiLoader.resources["../resources/pipes/finish_unfilled.png"].texture),this.spriteContainer.stage.addChild(r),n=["../resources/pipes/finish_unfilled.png","../resources/pipes/finish_filled.png"]})):"straight"==e[t][s].type?this.pixiLoader.load((()=>{r=new PIXI.Sprite(this.pixiLoader.resources["../resources/pipes/straight_unfilled.png"].texture),this.spriteContainer.stage.addChild(r),n=["../resources/pipes/straight_unfilled.png","../resources/pipes/straight_filled.png"]})):"duple"==e[t][s].type?this.pixiLoader.load((()=>{r=new PIXI.Sprite(this.pixiLoader.resources["../resources/pipes/duple_unfilled.png"].texture),this.spriteContainer.stage.addChild(r),n=["../resources/pipes/duple_unfilled.png","../resources/pipes/duple_filled.png"]})):"triple"==e[t][s].type?this.pixiLoader.load((()=>{r=new PIXI.Sprite(this.pixiLoader.resources["../resources/pipes/triple_unfilled.png"].texture),this.spriteContainer.stage.addChild(r),n=["../resources/pipes/triple_unfilled.png","../resources/pipes/triple_filled.png"]})):"cross"==e[t][s].type&&this.pixiLoader.load((()=>{r=new PIXI.Sprite(this.pixiLoader.resources["../resources/pipes/cross_unfilled.png"].texture),this.spriteContainer.stage.addChild(r),n=["../resources/pipes/cross_unfilled.png","../resources/pipes/cross_filled.png"]})),r&&(r.interactive=!0,r.buttonMode=!0,r.anchor.set(.5),r.width=100,r.height=100,r.x=100*s+250,r.y=100*t+75,r.on("pointerup",this.rotatePipe.bind(this,p,!1))),this.pipes.push(r),this.pipeMatrix[t].push(new i(e[t][s].type,[t,s],o,n||[])),"waterfall"==e[t][s].type?this.waterfallPipes.push(this.pipeMatrix[t][s]):"finish"==e[t][s].type&&this.pipesToWin.push(this.pipeMatrix[t][s]),p++}}this.pipeMatrixXLength=e[0].length;for(let i=0;i<this.pipes.length;i++)this.rotatePipe(i,!0);this.checkWaterPath(),this.waterFiller()}rotatePipe(i,e){let t=i%this.pipeMatrixXLength,s=(i-t)/this.pipeMatrixXLength;"cross"!=this.pipeMatrix[s][t].type&&"waterfall"!=this.pipeMatrix[s][t].type&&this.pipes[i]&&(this.pipeMatrix[s][t].changeRotation(),this.pipes[i].rotation=this.pipeMatrix[s][t].rotation*Math.PI/180,e||(this.audio.play(),this.checkWaterPath(),this.waterFiller(),this.isWin()))}isWin(){let i=this.pipesToWin.length;for(let e=0;e<this.pipesToWin.length;e++)this.pipesToWin[e].filled&&(i-=1);0==i&&(this.pipes.forEach((i=>{i&&i.removeAllListeners()})),setTimeout(this.getMenu,400))}waterFiller(){for(let i=0;i<this.pipes.length;i++){let e=i%this.pipeMatrixXLength,t=(i-e)/this.pipeMatrixXLength;this.pipeMatrix[t][e].filled?this.pipeMatrix[t][e].image&&(this.pipeMatrix[t][e].image=this.pipeMatrix[t][e].imageList[1],this.pipes[i].texture=PIXI.Texture.from(this.pipeMatrix[t][e].image)):this.pipeMatrix[t][e].filled||this.pipeMatrix[t][e].image&&(this.pipeMatrix[t][e].image=this.pipeMatrix[t][e].imageList[0],this.pipes[i].texture=PIXI.Texture.from(this.pipeMatrix[t][e].image))}}checkWaterPath(){let i=[];for(let i=0;i<this.pipeMatrix.length;i++)for(let e=0;e<this.pipeMatrix[i].length;e++)"waterfall"!=this.pipeMatrix[i][e].type&&(this.pipeMatrix[i][e].filled=!1);for(let e=0;e<this.waterfallPipes.length;e++)i.push(this.waterfallPipes[e]);for(;i.length>0;){if(1==i[0].jointPoints[0]){let e=i[0].coordinates[0]-1,t=i[0].coordinates[1];e>=0&&t>=0&&e<this.pipeMatrix.length&&t<this.pipeMatrix[0].length&&(1!=this.pipeMatrix[e][t].jointPoints[2]||this.pipeMatrix[e][t].filled||(this.pipeMatrix[e][t].filled=!0,i.push(this.pipeMatrix[e][t])))}if(1==i[0].jointPoints[1]){let e=i[0].coordinates[0],t=i[0].coordinates[1]+1;e>=0&&t>=0&&e<this.pipeMatrix.length&&t<this.pipeMatrix[0].length&&(1!=this.pipeMatrix[e][t].jointPoints[3]||this.pipeMatrix[e][t].filled||(this.pipeMatrix[e][t].filled=!0,i.push(this.pipeMatrix[e][t])))}if(1==i[0].jointPoints[2]){let e=i[0].coordinates[0]+1,t=i[0].coordinates[1];e>=0&&t>=0&&e<this.pipeMatrix.length&&t<this.pipeMatrix[0].length&&(1!=this.pipeMatrix[e][t].jointPoints[0]||this.pipeMatrix[e][t].filled||(this.pipeMatrix[e][t].filled=!0,i.push(this.pipeMatrix[e][t])))}if(1==i[0].jointPoints[3]){let e=i[0].coordinates[0],t=i[0].coordinates[1]-1;e>=0&&t>=0&&e<this.pipeMatrix.length&&t<this.pipeMatrix[0].length&&(1!=this.pipeMatrix[e][t].jointPoints[1]||this.pipeMatrix[e][t].filled||(this.pipeMatrix[e][t].filled=!0,i.push(this.pipeMatrix[e][t])))}i.shift()}}}new class{spriteContainer;pixiLoader=new PIXI.Loader;level=0;levelGonfig;fieldLink;constructor(){this.spriteContainer=new PIXI.Application({width:800,height:700,backgroundColor:1612219}),document.body.appendChild(this.spriteContainer.view),this.pixiLoader.add("../resources/backgrounds/beach.jpg").add("../resources/buttons/grey_button.png").add("../resources/pipes/waterfall.png").add("../resources/pipes/finish_unfilled.png").add("../resources/pipes/finish_filled.png").add("../resources/pipes/straight_unfilled.png").add("../resources/pipes/straight_filled.png").add("../resources/pipes/duple_unfilled.png").add("../resources/pipes/duple_filled.png").add("../resources/pipes/triple_unfilled.png").add("../resources/pipes/triple_filled.png").add("../resources/pipes/cross_unfilled.png").add("../resources/pipes/cross_filled.png").add("../resources/elements/victory.jpg").add("../resources/elements/logo.png").load((()=>{const i=new PIXI.Sprite(this.pixiLoader.resources["../resources/backgrounds/beach.jpg"].texture);this.spriteContainer.stage.addChild(i)})),this.getMenu()}getMenu(){this.clearStage(),this.pixiLoader.load((()=>{const i=new PIXI.Sprite(this.pixiLoader.resources["../resources/buttons/grey_button.png"].texture);if(i.anchor.set(.5),i.x=400,i.y=500,i.interactive=!0,i.buttonMode=!0,i.on("pointerup",this.nextLevel.bind(this)),this.spriteContainer.stage.addChild(i),0==this.level){const i=new PIXI.Sprite(this.pixiLoader.resources["../resources/elements/logo.png"].texture);this.spriteContainer.stage.addChild(i)}if(0!=this.level){const i=new PIXI.Sprite(this.pixiLoader.resources["../resources/elements/victory.jpg"].texture);i.y=350,this.spriteContainer.stage.addChild(i)}}))}nextLevel(){this.clearStage(),this.level++,this.levelGonfig=levelConfigs.find((i=>i.level==this.level)),this.levelGonfig?this.fieldLink=new e(this.levelGonfig.pipeMatrix,this.getMenu.bind(this),this.spriteContainer,this.pixiLoader):(this.level=0,this.getMenu())}clearStage(){for(let i=this.spriteContainer.stage.children.length;i>=1;i--)this.spriteContainer.stage.removeChild(this.spriteContainer.stage.children[i])}}}},e={};function t(s){var r=e[s];if(void 0!==r)return r.exports;var p=e[s]={exports:{}};return i[s](p,p.exports,t),p.exports}t.n=i=>{var e=i&&i.__esModule?()=>i.default:()=>i;return t.d(e,{a:e}),e},t.d=(i,e)=>{for(var s in e)t.o(e,s)&&!t.o(i,s)&&Object.defineProperty(i,s,{enumerable:!0,get:e[s]})},t.o=(i,e)=>Object.prototype.hasOwnProperty.call(i,e),(()=>{"use strict";t(691)})()})();